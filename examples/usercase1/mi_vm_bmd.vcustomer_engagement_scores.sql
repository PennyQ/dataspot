#DATASPOT-TERADATA
replace view MI_vm_bmd.vcustomer_engagement_scoresAS (SEL bc		,maand		,CASE WHEN ed_say1 = Least(ed_say1, ed_say2) THEN 1 WHEN ed_say2 = Least(ed_say1, ed_say2) THEN 2 END  AS say		,CASE WHEN ed_stay1 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 1 WHEN ed_stay2 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 2 WHEN ed_stay3 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 3 END  AS stay		,CASE WHEN ed_spend1 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 1 WHEN ed_spend2 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 2 WHEN ed_spend3 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 3 END  AS spend		,say+stay+spend AS CE_scoreFROM MI_vm_bmd.vcustomer_engagement_eucl_dist );
#DATASPOT-TERADATA
replace view MI_vm_bmd.vcustomer_engagement_scoresAS (SEL bc		,maand		,CASE WHEN ed_say1 = Least(ed_say1, ed_say2) THEN 1 WHEN ed_say2 = Least(ed_say1, ed_say2) THEN 2 END  AS say		,CASE WHEN ed_stay1 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 1 WHEN ed_stay2 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 2 WHEN ed_stay3 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 3 END  AS stay		,CASE WHEN ed_spend1 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 1 WHEN ed_spend2 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 2 WHEN ed_spend3 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 3 END  AS spend		,say+stay+spend AS CE_scoreFROM MI_vm_bmd.vcustomer_engagement_eucl_dist );
#DATASPOT-TERADATA
replace view MI_vm_bmd.vcustomer_engagement_scoresAS (SEL bc		,maand		,CASE WHEN ed_say1 = Least(ed_say1, ed_say2) THEN 1 WHEN ed_say2 = Least(ed_say1, ed_say2) THEN 2 END  AS say		,CASE WHEN ed_stay1 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 1 WHEN ed_stay2 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 2 WHEN ed_stay3 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 3 END  AS stay		,CASE WHEN ed_spend1 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 1 WHEN ed_spend2 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 2 WHEN ed_spend3 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 3 END  AS spend		,say+stay+spend AS CE_scoreFROM MI_vm_bmd.vcustomer_engagement_eucl_dist );
#DATASPOT-TERADATA
replace view MI_vm_bmd.vcustomer_engagement_scoresAS (SEL bc		,maand		,CASE WHEN ed_say1 = Least(ed_say1, ed_say2) THEN 1 WHEN ed_say2 = Least(ed_say1, ed_say2) THEN 2 END  AS say		,CASE WHEN ed_stay1 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 1 WHEN ed_stay2 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 2 WHEN ed_stay3 = Least(ed_stay1, ed_stay2, ed_stay3) THEN 3 END  AS stay		,CASE WHEN ed_spend1 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 1 WHEN ed_spend2 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 2 WHEN ed_spend3 = Least(ed_spend1, ed_spend2, ed_spend3) THEN 3 END  AS spend		,say+stay+spend AS CE_scoreFROM MI_vm_bmd.vcustomer_engagement_eucl_dist );
